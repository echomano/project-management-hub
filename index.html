<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blended Collective - Project Management Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        .studio77-bg { background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); }
        .studio77-text { color: #e5e5e5; }
        .studio77-accent { color: #00ff88; }
        .studio77-card { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .studio77-btn { background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%); color: #1a1a1a; }
        .studio77-btn:hover { background: linear-gradient(135deg, #00cc6a 0%, #00ff88 100%); }
    </style>
</head>
<body class="studio77-bg min-h-screen studio77-text">
    <div id="loadingScreen" class="fixed inset-0 studio77-bg flex items-center justify-center z-50">
        <div class="text-center">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-studio77-accent mx-auto"></div>
            <p class="mt-4 text-lg">Loading Project Hub...</p>
        </div>
    </div>

    <div id="mainApp" class="hidden">
        <header class="studio77-card m-4 rounded-lg p-6">
            <div class="flex items-center justify-between">
                <div>
                    <h1 id="projectTitle" class="text-3xl font-bold studio77-text mb-2" contenteditable="true">Blended Collective Website Rebuild</h1>
                    <p id="projectPeriod" class="text-lg studio77-accent" contenteditable="true">Project Management Hub</p>
                </div>
                <div class="text-right">
                    <p class="text-sm opacity-75">Last updated: <span id="lastUpdated">Just now</span></p>
                    <p class="text-sm opacity-75">Status: <span class="studio77-accent">Active</span></p>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 m-4">
            <!-- Prerequisites Section -->
            <div class="studio77-card rounded-lg p-6">
                <h2 class="text-xl font-semibold mb-4 flex items-center">
                    <i class="fas fa-check-circle studio77-accent mr-2"></i>
                    Prerequisites
                </h2>
                <div id="prerequisitesList" class="space-y-3">
                    <!-- Prerequisites will be loaded here -->
                </div>
                <button onclick="addPrerequisite()" class="mt-4 studio77-btn px-4 py-2 rounded font-medium">
                    <i class="fas fa-plus mr-2"></i>Add Prerequisite
                </button>
            </div>

            <!-- Asset Categories Section -->
            <div class="studio77-card rounded-lg p-6">
                <h2 class="text-xl font-semibold mb-4 flex items-center">
                    <i class="fas fa-folder studio77-accent mr-2"></i>
                    Asset Categories
                </h2>
                <div id="assetCategoriesList" class="space-y-4">
                    <!-- Asset categories will be loaded here -->
                </div>
                <button onclick="addAssetCategory()" class="mt-4 studio77-btn px-4 py-2 rounded font-medium">
                    <i class="fas fa-plus mr-2"></i>Add Category
                </button>
            </div>
        </div>

        <!-- Phases Section -->
        <div class="studio77-card m-4 rounded-lg p-6">
            <h2 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-tasks studio77-accent mr-2"></i>
                Project Phases
            </h2>
            <div id="phasesList" class="space-y-4">
                <!-- Phases will be loaded here -->
            </div>
            <button onclick="addPhase()" class="mt-4 studio77-btn px-4 py-2 rounded font-medium">
                <i class="fas fa-plus mr-2"></i>Add Phase
            </button>
        </div>

        <!-- Milestones Section -->
        <div class="studio77-card m-4 rounded-lg p-6">
            <h2 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-flag studio77-accent mr-2"></i>
                Milestones
            </h2>
            <div id="milestonesList" class="space-y-3">
                <!-- Milestones will be loaded here -->
            </div>
            <button onclick="addMilestone()" class="mt-4 studio77-btn px-4 py-2 rounded font-medium">
                <i class="fas fa-plus mr-2"></i>Add Milestone
            </button>
        </div>

        <!-- Calls Section -->
        <div class="studio77-card m-4 rounded-lg p-6">
            <h2 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-phone studio77-accent mr-2"></i>
                Scheduled Calls
            </h2>
            <div id="callsList" class="space-y-3">
                <!-- Calls will be loaded here -->
            </div>
            <button onclick="addCall()" class="mt-4 studio77-btn px-4 py-2 rounded font-medium">
                <i class="fas fa-plus mr-2"></i>Schedule Call
            </button>
        </div>

        <!-- Change Log Section -->
        <div class="studio77-card m-4 rounded-lg p-6">
            <h2 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-history studio77-accent mr-2"></i>
                Change Log
            </h2>
            <div id="changeLogList" class="space-y-2 max-h-60 overflow-y-auto">
                <!-- Change log will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        let projectData = {};

        // Initialize the application
        async function initApp() {
            try {
                await loadProjectData();
                renderAllSections();
                hideLoadingScreen();
            } catch (error) {
                console.error('Failed to initialize app:', error);
                hideLoadingScreen();
                showError('Failed to load project data');
            }
        }

        // Load project data from API
        async function loadProjectData() {
            try {
                const response = await fetch('/api/data');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                projectData = await response.json();
                
                // Update title and period
                document.getElementById('projectTitle').textContent = projectData.title || 'Untitled Project';
                document.getElementById('projectPeriod').textContent = projectData.period || 'No period set';
                
                return projectData;
            } catch (error) {
                console.error('Error loading project data:', error);
                // Fallback to empty data structure
                projectData = {
                    title: 'Blended Collective Website Rebuild',
                    period: 'Project Management Hub',
                    prerequisites: [],
                    assetCategories: [],
                    phases: [],
                    milestones: [],
                    calls: [],
                    changeLog: []
                };
                return projectData;
            }
        }

        // Save project data to API
        async function saveProjectData() {
            try {
                const response = await fetch('/api/data', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(projectData)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                showSuccess('Changes saved successfully');
                updateChangeLog('UPDATE', 'Updated project data');
                document.getElementById('lastUpdated').textContent = new Date().toLocaleString();
                
            } catch (error) {
                console.error('Error saving project data:', error);
                showError('Failed to save changes');
            }
        }

        // Render all sections
        function renderAllSections() {
            renderPrerequisites();
            renderAssetCategories();
            renderPhases();
            renderMilestones();
            renderCalls();
            renderChangeLog();
        }

        // Prerequisites functions
        function renderPrerequisites() {
            const container = document.getElementById('prerequisitesList');
            if (!projectData.prerequisites) projectData.prerequisites = [];
            
            container.innerHTML = projectData.prerequisites.map(item => `
                <div class="flex items-center justify-between p-3 bg-black bg-opacity-20 rounded">
                    <div class="flex items-center flex-1">
                        <input type="checkbox" ${item.completed ? 'checked' : ''} 
                               onchange="togglePrerequisite(${item.id})" 
                               class="mr-3 w-4 h-4">
                        <span class="${item.completed ? 'line-through opacity-60' : ''}">${item.item}</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button onclick="editPrerequisite(${item.id})" class="text-blue-400 hover:text-blue-300">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="removePrerequisite(${item.id})" class="text-red-400 hover:text-red-300">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function addPrerequisite() {
            const item = prompt('Enter prerequisite item:');
            if (!item) return;

            const newItem = {
                id: Date.now(),
                project_id: "550e8400-e29b-41d4-a716-446655440000",
                item: item,
                completed: false,
                updated_by: "User",
                updated_at: new Date().toISOString(),
                comments: ""
            };

            projectData.prerequisites.push(newItem);
            renderPrerequisites();
            saveProjectData();
        }

        function togglePrerequisite(id) {
            const item = projectData.prerequisites.find(p => p.id === id);
            if (item) {
                item.completed = !item.completed;
                item.updated_at = new Date().toISOString();
                renderPrerequisites();
                saveProjectData();
            }
        }

        function editPrerequisite(id) {
            const item = projectData.prerequisites.find(p => p.id === id);
            if (item) {
                const newText = prompt('Edit prerequisite:', item.item);
                if (newText !== null) {
                    item.item = newText;
                    item.updated_at = new Date().toISOString();
                    renderPrerequisites();
                    saveProjectData();
                }
            }
        }

        function removePrerequisite(id) {
            if (confirm('Are you sure you want to remove this prerequisite?')) {
                projectData.prerequisites = projectData.prerequisites.filter(p => p.id !== id);
                renderPrerequisites();
                saveProjectData();
            }
        }

        // Asset Categories functions
        function renderAssetCategories() {
            const container = document.getElementById('assetCategoriesList');
            if (!projectData.assetCategories) projectData.assetCategories = [];
            
            container.innerHTML = projectData.assetCategories.map(category => `
                <div class="border-l-4 border-studio77-accent pl-4">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="font-semibold">${category.name}</h3>
                        <div class="space-x-2">
                            <button onclick="addAssetItem(${category.id})" class="text-green-400 hover:text-green-300">
                                <i class="fas fa-plus"></i>
                            </button>
                            <button onclick="editAssetCategory(${category.id})" class="text-blue-400 hover:text-blue-300">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="removeAssetCategory(${category.id})" class="text-red-400 hover:text-red-300">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="space-y-2 ml-4">
                        ${(category.asset_items || []).map(assetItem => `
                            <div class="flex items-center justify-between p-2 bg-black bg-opacity-10 rounded">
                                <div class="flex items-center">
                                    <input type="checkbox" ${assetItem.completed ? 'checked' : ''} 
                                           onchange="toggleAssetItem(${category.id}, ${assetItem.id})" 
                                           class="mr-2 w-4 h-4">
                                    <span class="${assetItem.completed ? 'line-through opacity-60' : ''}">${assetItem.item}</span>
                                </div>
                                <button onclick="removeAssetItem(${category.id}, ${assetItem.id})" class="text-red-400 hover:text-red-300">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function addAssetCategory() {
            const name = prompt('Enter category name:');
            if (!name) return;

            const newCategory = {
                id: Date.now(),
                project_id: "550e8400-e29b-41d4-a716-446655440000",
                name: name,
                updated_by: "User",
                updated_at: new Date().toISOString(),
                comments: "",
                asset_items: []
            };

            projectData.assetCategories.push(newCategory);
            renderAssetCategories();
            saveProjectData();
        }

        function addAssetItem(categoryId) {
            const item = prompt('Enter asset item:');
            if (!item) return;

            const category = projectData.assetCategories.find(c => c.id === categoryId);
            if (category) {
                if (!category.asset_items) category.asset_items = [];
                
                const newItem = {
                    id: Date.now(),
                    item: item,
                    completed: false,
                    updated_at: new Date().toISOString(),
                    updated_by: "User",
                    category_id: categoryId
                };

                category.asset_items.push(newItem);
                renderAssetCategories();
                saveProjectData();
            }
        }

        function toggleAssetItem(categoryId, itemId) {
            const category = projectData.assetCategories.find(c => c.id === categoryId);
            if (category && category.asset_items) {
                const item = category.asset_items.find(i => i.id === itemId);
                if (item) {
                    item.completed = !item.completed;
                    item.updated_at = new Date().toISOString();
                    renderAssetCategories();
                    saveProjectData();
                }
            }
        }

        function editAssetCategory(id) {
            const category = projectData.assetCategories.find(c => c.id === id);
            if (category) {
                const newName = prompt('Edit category name:', category.name);
                if (newName !== null) {
                    category.name = newName;
                    category.updated_at = new Date().toISOString();
                    renderAssetCategories();
                    saveProjectData();
                }
            }
        }

        function removeAssetCategory(id) {
            if (confirm('Are you sure you want to remove this category and all its items?')) {
                projectData.assetCategories = projectData.assetCategories.filter(c => c.id !== id);
                renderAssetCategories();
                saveProjectData();
            }
        }

        function removeAssetItem(categoryId, itemId) {
            const category = projectData.assetCategories.find(c => c.id === categoryId);
            if (category && category.asset_items) {
                category.asset_items = category.asset_items.filter(i => i.id !== itemId);
                renderAssetCategories();
                saveProjectData();
            }
        }

        // Phases functions
        function renderPhases() {
            const container = document.getElementById('phasesList');
            if (!projectData.phases) projectData.phases = [];
            
            container.innerHTML = projectData.phases.map(phase => `
                <div class="border border-gray-600 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-3">
                        <div>
                            <h3 class="font-semibold text-lg">${phase.name}</h3>
                            <p class="text-sm studio77-accent">${phase.period}</p>
                        </div>
                        <div class="space-x-2">
                            <button onclick="addTask(${phase.id})" class="text-green-400 hover:text-green-300">
                                <i class="fas fa-plus"></i>
                            </button>
                            <button onclick="editPhase(${phase.id})" class="text-blue-400 hover:text-blue-300">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="removePhase(${phase.id})" class="text-red-400 hover:text-red-300">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="space-y-2">
                        ${(phase.tasks || []).map(task => `
                            <div class="flex items-center justify-between p-3 bg-black bg-opacity-20 rounded">
                                <div class="flex-1">
                                    <div class="flex items-center space-x-3">
                                        <span class="font-medium">${task.task}</span>
                                        <select onchange="updateTaskStatus(${phase.id}, ${task.id}, this.value)" 
                                                class="bg-gray-700 text-white px-2 py-1 rounded text-sm">
                                            <option value="not-started" ${task.status === 'not-started' ? 'selected' : ''}>Not Started</option>
                                            <option value="in-progress" ${task.status === 'in-progress' ? 'selected' : ''}>In Progress</option>
                                            <option value="completed" ${task.status === 'completed' ? 'selected' : ''}>Completed</option>
                                            <option value="pending" ${task.status === 'pending' ? 'selected' : ''}>Pending</option>
                                        </select>
                                    </div>
                                    <div class="text-sm opacity-75 mt-1">
                                        Assigned to: ${task.assignee} | Due: ${task.due_date}
                                    </div>
                                </div>
                                <button onclick="removeTask(${phase.id}, ${task.id})" class="text-red-400 hover:text-red-300 ml-4">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function addPhase() {
            const name = prompt('Enter phase name:');
            if (!name) return;
            
            const period = prompt('Enter phase period:') || 'TBD';

            const newPhase = {
                id: Date.now(),
                project_id: "550e8400-e29b-41d4-a716-446655440000",
                name: name,
                period: period,
                updated_by: "User",
                updated_at: new Date().toISOString(),
                comments: "",
                tasks: []
            };

            projectData.phases.push(newPhase);
            renderPhases();
            saveProjectData();
        }

        function addTask(phaseId) {
            const task = prompt('Enter task name:');
            if (!task) return;
            
            const assignee = prompt('Assign to:') || 'Unassigned';
            const dueDate = prompt('Due date:') || 'TBD';

            const phase = projectData.phases.find(p => p.id === phaseId);
            if (phase) {
                if (!phase.tasks) phase.tasks = [];
                
                const newTask = {
                    id: Date.now(),
                    task: task,
                    status: 'not-started',
                    assignee: assignee,
                    due_date: dueDate,
                    phase_id: phaseId,
                    updated_at: new Date().toISOString(),
                    updated_by: "User",
                    comments: ""
                };

                phase.tasks.push(newTask);
                renderPhases();
                saveProjectData();
            }
        }

        function updateTaskStatus(phaseId, taskId, newStatus) {
            const phase = projectData.phases.find(p => p.id === phaseId);
            if (phase && phase.tasks) {
                const task = phase.tasks.find(t => t.id === taskId);
                if (task) {
                    task.status = newStatus;
                    task.updated_at = new Date().toISOString();
                    saveProjectData();
                }
            }
        }

        function editPhase(id) {
            const phase = projectData.phases.find(p => p.id === id);
            if (phase) {
                const newName = prompt('Edit phase name:', phase.name);
                if (newName !== null) {
                    phase.name = newName;
                    const newPeriod = prompt('Edit phase period:', phase.period);
                    if (newPeriod !== null) {
                        phase.period = newPeriod;
                        phase.updated_at = new Date().toISOString();
                        renderPhases();
                        saveProjectData();
                    }
                }
            }
        }

        function removePhase(id) {
            if (confirm('Are you sure you want to remove this phase and all its tasks?')) {
                projectData.phases = projectData.phases.filter(p => p.id !== id);
                renderPhases();
                saveProjectData();
            }
        }

        function removeTask(phaseId, taskId) {
            const phase = projectData.phases.find(p => p.id === phaseId);
            if (phase && phase.tasks) {
                phase.tasks = phase.tasks.filter(t => t.id !== taskId);
                renderPhases();
                saveProjectData();
            }
        }

        // Milestones functions
        function renderMilestones() {
            const container = document.getElementById('milestonesList');
            if (!projectData.milestones) projectData.milestones = [];
            
            container.innerHTML = projectData.milestones.map(milestone => `
                <div class="flex items-center justify-between p-3 bg-black bg-opacity-20 rounded">
                    <div class="flex items-center flex-1">
                        <input type="checkbox" ${milestone.completed ? 'checked' : ''} 
                               onchange="toggleMilestone(${milestone.id})" 
                               class="mr-3 w-4 h-4">
                        <div>
                            <div class="font-medium ${milestone.completed ? 'line-through opacity-60' : ''}">${milestone.title}</div>
                            <div class="text-sm opacity-75">${milestone.description}</div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button onclick="editMilestone(${milestone.id})" class="text-blue-400 hover:text-blue-300">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="removeMilestone(${milestone.id})" class="text-red-400 hover:text-red-300">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function addMilestone() {
            const title = prompt('Enter milestone title:');
            if (!title) return;
            
            const description = prompt('Enter milestone description:') || '';

            const newMilestone = {
                id: Date.now(),
                project_id: "550e8400-e29b-41d4-a716-446655440000",
                title: title,
                description: description,
                completed: false,
                updated_by: "User",
                updated_at: new Date().toISOString(),
                comments: ""
            };

            projectData.milestones.push(newMilestone);
            renderMilestones();
            saveProjectData();
        }

        function toggleMilestone(id) {
            const milestone = projectData.milestones.find(m => m.id === id);
            if (milestone) {
                milestone.completed = !milestone.completed;
                milestone.updated_at = new Date().toISOString();
                renderMilestones();
                saveProjectData();
            }
        }

        function editMilestone(id) {
            const milestone = projectData.milestones.find(m => m.id === id);
            if (milestone) {
                const newTitle = prompt('Edit milestone title:', milestone.title);
                if (newTitle !== null) {
                    milestone.title = newTitle;
                    const newDescription = prompt('Edit milestone description:', milestone.description);
                    if (newDescription !== null) {
                        milestone.description = newDescription;
                        milestone.updated_at = new Date().toISOString();
                        renderMilestones();
                        saveProjectData();
                    }
                }
            }
        }

        function removeMilestone(id) {
            if (confirm('Are you sure you want to remove this milestone?')) {
                projectData.milestones = projectData.milestones.filter(m => m.id !== id);
                renderMilestones();
                saveProjectData();
            }
        }

        // Calls functions
        function renderCalls() {
            const container = document.getElementById('callsList');
            if (!projectData.calls) projectData.calls = [];
            
            container.innerHTML = projectData.calls.map(call => `
                <div class="p-3 bg-black bg-opacity-20 rounded">
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="font-medium">${call.title}</div>
                            <div class="text-sm opacity-75">${call.date} | ${call.attendees}</div>
                            <div class="text-sm mt-1">${call.description}</div>
                            <div class="text-xs studio77-accent mt-1">Status: ${call.status}</div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button onclick="editCall(${call.id})" class="text-blue-400 hover:text-blue-300">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="removeCall(${call.id})" class="text-red-400 hover:text-red-300">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function addCall() {
            const title = prompt('Enter call title:');
            if (!title) return;
            
            const date = prompt('Enter date and time:') || 'TBD';
            const attendees = prompt('Enter attendees:') || 'TBD';
            const description = prompt('Enter description:') || '';

            const newCall = {
                id: Date.now(),
                project_id: "550e8400-e29b-41d4-a716-446655440000",
                title: title,
                status: "Scheduled",
                description: description,
                date: date,
                attendees: attendees,
                updated_by: "User",
                updated_at: new Date().toISOString(),
                comments: ""
            };

            projectData.calls.push(newCall);
            renderCalls();
            saveProjectData();
        }

        function editCall(id) {
            const call = projectData.calls.find(c => c.id === id);
            if (call) {
                const newTitle = prompt('Edit call title:', call.title);
                if (newTitle !== null) {
                    call.title = newTitle;
                    const newDate = prompt('Edit date and time:', call.date);
                    if (newDate !== null) {
                        call.date = newDate;
                        const newAttendees = prompt('Edit attendees:', call.attendees);
                        if (newAttendees !== null) {
                            call.attendees = newAttendees;
                            const newDescription = prompt('Edit description:', call.description);
                            if (newDescription !== null) {
                                call.description = newDescription;
                                call.updated_at = new Date().toISOString();
                                renderCalls();
                                saveProjectData();
                            }
                        }
                    }
                }
            }
        }

        function removeCall(id) {
            if (confirm('Are you sure you want to remove this call?')) {
                projectData.calls = projectData.calls.filter(c => c.id !== id);
                renderCalls();
                saveProjectData();
            }
        }

        // Change log functions
        function renderChangeLog() {
            const container = document.getElementById('changeLogList');
            if (!projectData.changeLog) projectData.changeLog = [];
            
            // Show only the last 10 changes
            const recentChanges = projectData.changeLog.slice(-10).reverse();
            
            container.innerHTML = recentChanges.map(change => `
                <div class="flex items-center justify-between p-2 bg-black bg-opacity-10 rounded text-sm">
                    <div>
                        <span class="font-medium">${change.user}</span>
                        <span class="opacity-75">- ${change.details}</span>
                    </div>
                    <div class="text-xs opacity-60">
                        ${new Date(change.timestamp).toLocaleString()}
                    </div>
                </div>
            `).join('');
        }

        function updateChangeLog(action, details) {
            if (!projectData.changeLog) projectData.changeLog = [];
            
            const logEntry = {
                id: Date.now(),
                user: "User",
                action: action,
                details: details,
                timestamp: new Date().toISOString()
            };
            
            projectData.changeLog.push(logEntry);
            renderChangeLog();
        }

        // Utility functions
        function hideLoadingScreen() {
            document.getElementById('loadingScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
        }

        function showSuccess(message) {
            // Simple success notification
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded shadow-lg z-50';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function showError(message) {
            // Simple error notification
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-red-600 text-white px-4 py-2 rounded shadow-lg z-50';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        // Handle title and period editing
        document.addEventListener('DOMContentLoaded', function() {
            const projectTitle = document.getElementById('projectTitle');
            const projectPeriod = document.getElementById('projectPeriod');
            
            projectTitle.addEventListener('blur', function() {
                projectData.title = this.textContent;
                saveProjectData();
            });
            
            projectPeriod.addEventListener('blur', function() {
                projectData.period = this.textContent;
                saveProjectData();
            });
            
            // Initialize the app
            initApp();
        });

        // Auto-save when user types in editable fields
        document.addEventListener('input', function(e) {
            if (e.target.contentEditable === 'true') {
                clearTimeout(window.autoSaveTimer);
                window.autoSaveTimer = setTimeout(() => {
                    if (e.target.id === 'projectTitle') {
                        projectData.title = e.target.textContent;
                    } else if (e.target.id === 'projectPeriod') {
                        projectData.period = e.target.textContent;
                    }
                    saveProjectData();
                }, 1000);
            }
        });
    </script>
</body>
</html>
